---
title: "MS-Wordãƒ•ã‚¡ã‚¤ãƒ«(.docx)ã‹ã‚‰Goã®ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†ã§æ–‡ç« ã‚’å–ã‚Šå‡ºã™ã¨ãƒãƒƒã‚¯æ„ŸãŒã‚ã£ã¦æ¥½ã—ã„"
emoji: "ğŸ“"
type: "tech"
topics: ["go", "golang", "word"]
published: true
---

## ã¯ã˜ã‚ã«
ã“ã®è¨˜äº‹ã¯è¡¨é¡Œã«é–¢ã™ã‚‹éŠã³ã§ã™ã€‚

ç´°ã‹ãªå®Ÿè£…æ–¹æ³•ã¯è¨˜äº‹ä¸­ã®ç‰©ã¨é•ã„ã¾ã™ãŒã€åŒç­‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ä¸‹è¨˜repo.ã«æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚ã‚ˆã‚ã—ã‘ã‚Œã°ã”å‚ç…§ãã ã•ã„ã€‚

https://github.com/tenkoh/go-docc

èª­ã¿å‡ºã—ãŸå†…å®¹ã‚’æ¨™æº–å‡ºåŠ›ã«åãå‡ºã™ç°¡æ˜“appã‚‚ã‚ã‚Šã¾ã™ã€‚
```shell
go installl https://github.com/tenkoh/go-docc/cmd/docc@latest
```

## .docxã®è‹¦æ‚©
- ç§ã¯ã€ç§ã¯ãŸã æ–‡æ›¸ã®ä¸­èº«ã‚’å–å¾—ã—ãŸã„ã®ã§ã™ã€‚ãã®ãŸã‚ã ã‘ã«ã€ã‚ã–ã‚ã–Microsoft Officeã•ã‚“ã«é ¼ã‚ŠãŸããªã„ã®ã§ã™ã€‚
- å¤§é‡ã®.docxã‚’å‡¦ç†ã™ã‚‹ã®ã«ã€äººæµ·æˆ¦è¡“ãªã‚“ã¦å«Œãªã®ã§ã™ã€‚ãƒãƒƒãƒå‡¦ç†ã‚’ãŠæ‰‹è»½ã«ã‚„ã‚ŠãŸã„ã®ã§ã™ã€‚

ã“ã®ã‚ˆã†ãªãƒ‹ãƒ¼ã‚ºã¯å¤šã€…ã‚ã‚‹ã‚ˆã†ã§ã€.docxã•ã‚“ã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå…ˆé”ã«ã‚ˆã‚Šä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚Goã§å®Ÿè£…ã•ã‚ŒãŸã‚‚ã®ã ã¨ã€ä¾‹ãˆã°æ¬¡ã®ï¼’ã¤ã‚’ãŠè¦‹ã‹ã‘ã—ã¾ã—ãŸã€‚ã©ã¡ã‚‰ã‚‚ãªã‹ãªã‹å¤šæ©Ÿèƒ½ã§ã™ã€‚ã™ã”ã„ã§ã™ã€‚

https://github.com/unidoc/unioffice

https://github.com/sajari/docconv

## é–‘è©±ä¼‘é¡Œ
ã•ã¦ã€è‰¯ãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã™ãŒ`.docx`ã®å®Ÿæ…‹ã¯ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ãã®å†…éƒ¨ã«XMLå½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦å˜ã«æ–‡æ›¸ã®ä¸­èº«ã‚’å–å¾—ã—ãŸã„ã ã‘ã§ã‚ã‚Œã°ã€`.docx`ã‚’å±•é–‹ã—ã¦å¾—ã‚‰ã‚Œã‚‹`word/document.xml`ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ã‚ã’ã‚‹ã ã‘ã§ã„ã‘ã‚‹ã¯ãšã§ã™ã€‚

ãã†ã—ãŸå‡¦ç†ã§ã¯Goã®ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†ãŒç«ã‚’å¹ããã†ã§ã™ã­ï¼ˆç§è¦‹ï¼‰ã€‚ **ç„äººæ„ŸãŒã‚ã£ã¦è‰¯ã„ã®ã§ç„¡é§„ã«ãƒˆãƒ©ã‚¤ã—ã¦ã¿ã¾ã—ã‚‡ã†**

## å®Ÿè£…
:::message
ä¸‹è¨˜ã®å®Ÿè£…ã§ã¯ã€æœ€çµ‚çš„ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹æ®µéšã§æ–‡æ›¸å…¨ä½“ã‚’ãƒ¡ãƒ¢ãƒªä¸Šã«èª­è¾¼ã‚“ã§ã„ã‚‹ã®ã§ã€ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ã«ã¯ã‚ˆã‚Šè‰¯ã„æ–¹æ³•ãŒã„ãã‚‰ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚ç°¡å˜åŒ–ã®ãŸã‚ã“ã®è¨˜äº‹ã§ã¯å‰²æ„›ã•ã›ã¦ä¸‹ã•ã„ã€‚
:::

:::message
å†—é•·ã«ãªã‚‹ã®ã§è¨˜äº‹ä¸­ã§ã¯ä¸€éƒ¨ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å‰²æ„›ã—ã¦ã„ã¾ã™
:::

`.docx`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’`archive/zip`ã§å±•é–‹ã—ã€è¿”ã‚Šå€¤ã®`[]*zip.File`ã®ä¸­ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åãŒ`word/document.xml`ã®ç‰©ã ã‘ã‚’æ¢ã—ã€`*zip.File`ã‚’Openã—ã¦å¾—ã‚‰ã‚Œã‚‹`io.ReadCloser`ã‚’`xml.NewDecoder`ã«æ¸¡ã—ã¾ã™ã€‚å¿…è¦ãªæ–‡ç« æƒ…å ±ã¯xmlã‚¿ã‚°ã®p>r>tã®ä¸­èº«ã ã‘ãªã®ã§ã€ãã‚Œã‚’çµåˆã—ã¦è¿”ã—ãŸã‚‰ãŠã—ã¾ã„ã§ã™ã€‚

```go
import (
	"archive/zip"
	"encoding/xml"
	"errors"
	"fmt"
	"io"
	"path/filepath"
)

var ErrDocumentsNotFound = errors.New("foo")

type Document struct {
	XMLName xml.Name `xml:"document"`
	Body    struct {
		P []struct {
			R []struct {
				T struct {
					Text  string `xml:",chardata"`
					Space string `xml:"space,attr"`
				} `xml:"t"`
			} `xml:"r"`
		} `xml:"p"`
	} `xml:"body"`
}

func Decode(docxPath string) ([]string, error) {
	archive, _ := zip.OpenReader(docxPath)
	defer archive.Close()

	for _, f := range archive.File {
		target := filepath.Clean("word/document.xml")
		if n := filepath.Clean(f.Name); n != target {
			continue
		}

		fd, _ := f.Open()
		defer fd.Close()

		ps, _ := decodeXML(fd)
		return ps, nil
	}
	return nil, ErrDocumentsNotFound
}

func decodeXML(r io.Reader) ([]string, error) {
	doc := new(Document)
	if err := xml.NewDecoder(r).Decode(doc); err != nil {
		return nil, fmt.Errorf("could not decode the document: %w", err)
	}
	ps := []string{}
	for _, p := range doc.Body.P {
		t := ""
		for _, r := range p.R {
			t = t + r.T.Text
		}
		ps = append(ps, t)
	}
	return ps, nil
}
```

## çµã³
é€”ä¸­ã§è¨˜è¼‰ã—ãŸã‚ˆã†ã«æ”¹å–„ã®ä½™åœ°ã—ã‹ãªã„ç°¡æ˜“å®Ÿè£…ã§ã™ãŒã€ã“ã‚Œã§ã‚‚ã†`.docx`ã‚’æ‰‹å‹•ã§é–‹ãæ—¥ã€…ã‹ã‚‰ã¯ãŠã•ã‚‰ã°ã§ã™ã€‚ãŠã‚ã¨ãŒã‚ˆã‚ã—ã„ã‚ˆã†ã§ã€‚